import numpy as np
import matplotlib.pyplot as plt

data_rnd = np.array([1.4579999999542181e-06, 1.4160000000318362e-06, 2.1249999999639613e-06, 1.4160000000318362e-06,
                     1.415999999920814e-06, 1.4160000000318362e-06, 1.6250000000050946e-06, 1.4170000000035543e-06,
                     1.37499999997015e-06, 1.415999999920814e-06, 2.041000000008175e-06, 1.958999999995825e-06,
                     1.958000000024107e-06, 1.4579999999542181e-06, 1.4170000000035543e-06, 1.415999999920814e-06,
                     1.4170000000035543e-06, 1.4160000000318362e-06, 1.4999999999876223e-06, 1.4170000000035543e-06,
                     1.6670000000384988e-06, 1.37499999997015e-06, 1.4590000000369585e-06, 1.416999999892532e-06,
                     1.4170000000035543e-06, 1.4579999999542181e-06, 1.4170000000035543e-06, 1.5000000000986446e-06,
                     1.4999999999876223e-06, 1.4580000000652404e-06, 1.37499999997015e-06, 1.4170000000035543e-06,
                     1.2667000000021744e-05, 1.3750000000811724e-06, 1.4580000000652404e-06, 1.958000000024107e-06,
                     1.4170000000035543e-06, 1.3750000000811724e-06, 1.4170000000035543e-06, 1.4170000000035543e-06,
                     1.4170000000035543e-06, 1.4170000000035543e-06, 1.4170000000035543e-06, 1.4160000000318362e-06,
                     1.4170000000035543e-06, 1.4170000000035543e-06, 1.4590000000369585e-06, 1.4999999999876223e-06,
                     1.3750000000811724e-06, 1.4170000000035543e-06, 2.082999999930557e-06, 1.4160000000318362e-06,
                     1.4580000000652404e-06, 1.4170000000035543e-06, 1.4170000000035543e-06, 1.4579999999542181e-06,
                     1.4170000000035543e-06, 1.3750000000811724e-06, 1.5419999999100042e-06, 1.4160000000318362e-06,
                     2.8750000000687947e-06, 1.4160000000318362e-06, 1.4160000000318362e-06, 1.415999999920814e-06,
                     1.4580000000652404e-06, 1.4170000000035543e-06, 1.4170000000035543e-06, 1.4170000000035543e-06,
                     1.4580000000652404e-06, 1.4170000000035543e-06, 1.415999999920814e-06, 4.792000000031216e-06,
                     1.24169999999868e-05, 1.4170000000035543e-06, 1.4579999999542181e-06, 1.4170000000035543e-06,
                     1.4170000000035543e-06, 1.4580000000652404e-06, 1.4160000000318362e-06, 1.4579999999542181e-06,
                     1.4580000000652404e-06, 1.4170000000035543e-06, 1.4170000000035543e-06, 1.4579999999542181e-06,
                     1.37499999997015e-06, 1.4160000000318362e-06, 1.4170000000035543e-06, 1.415999999920814e-06,
                     1.4580000000652404e-06, 1.916999999962421e-06, 1.415999999920814e-06, 2.1249999999639613e-06,
                     1.4999999999876223e-06, 4.915999999965948e-06, 1.5830000000827127e-06, 1.4579999999542181e-06,
                     1.4590000000369585e-06, 1.5829999999716904e-06, 1.4170000000035543e-06, 1.4589999999259362e-06,
                     1.6250000000050946e-06, 1.4170000000035543e-06, 1.37499999997015e-06, 1.4170000000035543e-06,
                     1.5420000000210266e-06, 1.37499999997015e-06, 2.3749999999989058e-06, 1.4579999999542181e-06,
                     1.37499999997015e-06, 1.958000000024107e-06, 1.999999999946489e-06, 1.4170000000035543e-06,
                     1.37499999997015e-06, 1.37499999997015e-06, 2.082999999930557e-06, 1.958000000024107e-06,
                     1.416999999892532e-06, 1.4170000000035543e-06, 1.4170000000035543e-06, 2.041000000008175e-06,
                     1.37499999997015e-06, 1.4579999999542181e-06, 1.4170000000035543e-06, 1.4170000000035543e-06]

                    )
data_inp = np.array(
    [1.3330000001587905e-06, 1.3330000001587905e-06, 1.374999982317604e-06, 1.3750000107393134e-06,
     1.499999996212864e-06, 1.3750000107393134e-06, 1.3339999895833898e-06, 1.3330000001587905e-06,
     1.3330000001587905e-06, 1.3750000107393134e-06, 1.3750000107393134e-06, 1.3750000107393134e-06,
     1.499999996212864e-06, 1.3750000107393134e-06, 1.3330000001587905e-06, 1.3330000001587905e-06,
     1.3750000107393134e-06, 1.3750000107393134e-06, 1.374999982317604e-06, 1.3330000001587905e-06,
     1.416999992898127e-06, 1.499999996212864e-06, 1.3750000107393134e-06, 1.4159999750518182e-06,
     1.374999982317604e-06, 1.4159999750518182e-06, 1.3339999895833898e-06, 1.374999982317604e-06,
     1.3750000107393134e-06, 1.3340000180050993e-06, 1.3750000107393134e-06, 1.3750000107393134e-06,
     1.4579999856323411e-06, 1.374999982317604e-06, 1.3750000107393134e-06, 1.374999982317604e-06,
     1.374999982317604e-06, 1.416999992898127e-06, 1.3750000107393134e-06, 1.3330000001587905e-06,
     1.3330000001587905e-06, 1.3750000107393134e-06, 1.374999982317604e-06, 1.4160000034735276e-06,
     1.4580000140540506e-06, 1.3750000107393134e-06, 1.3340000180050993e-06, 1.3750000107393134e-06,
     1.3339999895833898e-06, 1.4160000034735276e-06, 1.416999992898127e-06, 1.374999982317604e-06,
     1.416999992898127e-06, 1.3330000001587905e-06, 1.3750000107393134e-06, 1.416999992898127e-06,
     1.3750000107393134e-06, 1.2920000074245763e-06, 1.374999982317604e-06, 1.3340000180050993e-06,
     1.3330000001587905e-06, 1.3750000107393134e-06, 1.3750000107393134e-06, 1.3750000107393134e-06,
     1.3750000107393134e-06, 1.3330000001587905e-06, 1.3750000107393134e-06, 1.3750000107393134e-06,
     1.499999996212864e-06, 1.3330000001587905e-06, 1.3750000107393134e-06, 1.3339999895833898e-06,
     1.416999992898127e-06, 1.374999982317604e-06, 1.374999982317604e-06, 1.3339999895833898e-06,
     1.3750000107393134e-06, 1.3330000001587905e-06, 1.3750000107393134e-06, 1.3750000107393134e-06,
     1.3330000001587905e-06, 1.3750000107393134e-06, 1.3330000001587905e-06, 1.3330000001587905e-06,
     1.3750000107393134e-06, 1.374999982317604e-06, 1.4580000140540506e-06, 1.3750000107393134e-06,
     1.3330000001587905e-06, 1.416999992898127e-06, 1.3750000107393134e-06, 1.3330000001587905e-06,
     1.3340000180050993e-06, 1.374999982317604e-06, 1.3750000107393134e-06, 1.3330000001587905e-06,
     1.3340000180050993e-06, 1.374999982317604e-06, 1.3750000107393134e-06, 1.3340000180050993e-06,
     1.3340000180050993e-06, 1.3339999895833898e-06, 1.3330000001587905e-06, 1.3330000001587905e-06,
     1.3330000001587905e-06, 1.3750000107393134e-06, 1.416999992898127e-06, 1.416999992898127e-06,
     1.3750000107393134e-06, 1.4590000034786499e-06, 1.3340000180050993e-06, 1.3330000001587905e-06,
     1.3750000107393134e-06, 1.416999992898127e-06, 1.3750000107393134e-06, 1.3750000107393134e-06,
     1.3330000001587905e-06, 1.3340000180050993e-06, 1.3340000180050993e-06, 1.3750000107393134e-06,
     1.3330000001587905e-06, 1.4170000213198364e-06, 1.3750000107393134e-06, 1.3750000107393134e-06]

)
np.random.shuffle(data_inp)
np.random.shuffle(data_rnd)

inp_mean = data_inp.mean()
inp_std = data_inp.std(ddof=0)

rnd_mean = data_rnd.mean()
rnd_std = data_rnd.std(ddof=0)


plt.figure(figsize=(24, 16), dpi=300)
x = list(range(1, len(data_inp) + 1))

plt.xticks(fontsize=40)
plt.yticks(fontsize=40)
plt.plot(x, data_inp, marker='o', linestyle='-', linewidth=1.5, label='Дисперсия на входах', color='green')
plt.axhline(inp_mean, color='cyan', linestyle='--', linewidth=1.2,
            label=f'Среднее дисперсии на входах = {inp_mean:.2f}')
plt.fill_between(x, inp_mean - inp_std, inp_mean + inp_std,
                 color='lightgreen', alpha=0.1,
                 label=f'Зона ±1σ для входов ({inp_std:.2f})')

plt.plot(x, data_rnd, marker='o', linestyle='-', linewidth=1.5, label='Дисперсия на случайном мн-ве',
         color='red')
plt.axhline(rnd_mean, color='brown', linestyle='--', linewidth=1.2,
            label=f'Среднее дисперсии на случайном мн-ве = {inp_mean:.2f}')
plt.fill_between(x, rnd_mean - rnd_std, rnd_mean + rnd_std,
                 color='lightcoral', alpha=0.1,
                 label=f'Зона ±1σ для случайного мн-ва ({rnd_std:.2f})')

plt.xlabel('Подстановки', fontsize=40)
plt.ylabel('Отнормированное время работы на подстановке', fontsize=40)
plt.title('Дисперсия времени работы SAT-решателя\nна входах и на случайных подстановках', fontsize=40)
plt.yscale('log')
# plt.legend(loc='upper center', bbox_to_anchor=(0.5, -0.08), ncol=6, fontsize=25)
plt.legend(fontsize=25)
plt.grid(True)
# plt.tight_layout()
plt.savefig('stats/disp_one_schema.png')
